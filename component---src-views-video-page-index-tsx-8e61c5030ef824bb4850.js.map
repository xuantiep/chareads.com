{"version":3,"sources":["webpack:///./src/components/Reveal/index.tsx","webpack:///./src/components/RelatedBooks/index.tsx","webpack:///./src/components/MarkdownWrapper/index.tsx","webpack:///./src/utils/hooks/useWindowSize.ts","webpack:///./src/components/Reveal/RevealTrigger.tsx","webpack:///./src/utils/urls/getQueryParameters.ts","webpack:///./src/views/VideoPage/VideoPlayer.tsx","webpack:///./src/views/VideoPage/VideoTimestamp.tsx","webpack:///./src/views/VideoPage/VideoTimestampList.tsx","webpack:///./src/views/VideoPage/VideoMeta.tsx","webpack:///./src/views/VideoPage/VideoOwnedBook.tsx","webpack:///./src/views/VideoPage/index.tsx","webpack:///./src/utils/urls/affiliates.ts","webpack:///./src/components/BookAffiliates/index.tsx"],"names":["StyledContent","styled","div","isOpen","isTransitioning","Reveal","children","open","ariaId","className","as","useState","setIsOpen","setIsTransitioning","contentHeight","setContentHeight","contentEl","createRef","useEffect","ref","current","clientHeight","setTimeout","id","aria-hidden","style","maxHeight","StyledWrapper","StyledTitleGridItem","GridItem","screenMin","m","StyledGrid","Grid","FONT","SIZE","S","screen","l","RelatedBooks","books","featuredSlugs","ownedSlug","length","full","size","map","book","featured","slug","includes","key","span","spanFromM","spanFromL","hideDetails","MarkdownWrapper","trim","COLOR","BACKGROUND_DARK","M","useWindowSize","window","width","height","getSize","innerWidth","innerHeight","windowSize","setWindowSize","handleResize","addEventListener","removeEventListener","StyledSummaryTrigger","button","WEIGHT","BOLD","screenMax","s","StyledIcon","i","RevealTrigger","onClick","aria-expanded","aria-controls","getQueryParameters","location","search","qs","parse","ignoreQueryPrefix","YouTubePlayerConfig","youtube","playerVars","rel","controls","VideoPlayer","youtubeId","isPlaying","setIsPlaying","setPlayedSeconds","videoComponent","backgroundColor","startAtSeconds","setStartAtSeconds","params","at","startAt","unformatTimestamp","AspectRatioWrapper","url","onPlay","onPause","onProgress","playedSeconds","progressInterval","playing","config","StyledVideoTimestamp","li","active","StyledTime","time","StyledDetails","StyledText","p","StyledBookLink","Link","StyledStarRating","StarRating","StyledReveal","VideoTimestamp","t","text","link","jumpToTimestamp","e","target","tagName","formatTimestamp","href","ArrowIcon","to","of7","rating7","BookAffiliates","links","BACKGROUND","StyledVideoTimestampList","ol","toVW","getWidthOfColumns","xl","BORDER_RADIUS","VideoTimestampList","segment","timestamps","startPlaying","seekTo","forEach","StyledAside","aside","StyledRevealTrigger","dl","StyledDt","dt","StyledDd","dd","VideoMeta","datePublished","viewCount","commentCount","windowWidth","BREAKPOINT","formatDate","parseInt","process","formatNumberInThousands","StyledLink","VideoOwnedBook","StyledTimestampGridItem","StyledMeta","GAP","L","XL","StyledTitleWrapper","StyledTitle","H","StyledBlockquote","blockquote","FAMILY","DECORATIVE","VideoPage","video","data","useRef","ownedBook","ownedBy","relatedBooks","featuredRelatedBookSlugs","filter","b","flipLayout","Layout","navTitle","navTitleLink","PATHS","VIDEOS","title","description","stripHtml","html","shareImage","image","childImageSharp","share","src","columnsFromL","columnsFromXL","colors","muted","columnsFromM","rows","rowsFromL","quote","dangerouslySetInnerHTML","__html","spanRows","spanRowsFromL","marginTop","marginBottom","alignSelf","AFFILIATES","GOODREADS","AMAZON","BOOK_DEPOSITORY","AFFILIATE_ACTIONS","StyledLi","StyledArrowIcon","Object","entries","affiliateAbbr","label","long"],"mappings":"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","file":"component---src-views-video-page-index-tsx-8e61c5030ef824bb4850.js","sourcesContent":["import React, { useState, useEffect, createRef } from 'react'\nimport styled from 'styled-components'\n\nconst TRANSITION_DURATION_IN_MS = 200\n\ninterface ContentProps {\n  ref: React.RefObject<React.ReactNode>\n  isOpen: boolean\n  isTransitioning: boolean\n  contentHeight: number\n  className?: string\n  as?: string\n}\n\nconst StyledContent = styled.div<ContentProps>`\n  margin: 0;\n  will-change: opacity, max-height;\n  transition: opacity ${TRANSITION_DURATION_IN_MS}ms ease-in-out, max-height ${TRANSITION_DURATION_IN_MS}ms ease-in-out;\n  overflow: hidden;\n\n  ${({ isOpen, isTransitioning }): string =>\n    !isOpen &&\n    !isTransitioning &&\n    `\n      position: absolute;\n      opacity: 0;\n      pointer-events: none;\n  `}\n\n  ${({ isTransitioning }): string =>\n    isTransitioning &&\n    `\n      opacity: 0;\n      max-height: 0;\n  `}\n\n  ${({ isOpen }): string =>\n    isOpen &&\n    `\n      opacity: 1;\n  `}\n`\n\ninterface Props {\n  children: React.ReactNode\n  open: boolean\n  ariaId?: string\n  className?: string\n  as?: string\n}\n\nconst Reveal: React.FC<Props> = ({ children, open, ariaId, className, as }) => {\n  const [isOpen, setIsOpen] = useState(open)\n  const [isTransitioning, setIsTransitioning] = useState(false)\n  const [contentHeight, setContentHeight] = useState(null)\n  const contentEl = createRef<HTMLDivElement>()\n\n  useEffect(() => {\n    if (open) {\n      const ref = contentEl.current as HTMLElement\n      setContentHeight(ref.clientHeight)\n      setIsTransitioning(true)\n    } else {\n      setIsOpen(false)\n      setTimeout(() => setIsTransitioning(false), TRANSITION_DURATION_IN_MS)\n    }\n  }, [open])\n\n  useEffect(() => {\n    if (isTransitioning && !isOpen) setTimeout(() => setIsOpen(true), 50)\n  }, [isTransitioning])\n\n  return (\n    <StyledContent\n      className={className}\n      ref={contentEl}\n      isOpen={isOpen}\n      isTransitioning={isTransitioning}\n      id={ariaId}\n      aria-hidden={!isOpen}\n      as={as}\n      style={{\n        maxHeight: isOpen && contentHeight,\n      }}\n    >\n      {children}\n    </StyledContent>\n  )\n}\n\nexport default Reveal\n","import React from 'react'\nimport styled from 'styled-components'\n\nimport Grid from 'components/Grid'\nimport GridItem from 'components/Grid/GridItem'\nimport H from 'components/H'\nimport { FONT } from 'styles/tokens'\nimport { screen, screenMin } from 'styles/responsive'\n\nimport { BookCardType } from 'types/book'\nimport BookCard from 'components/cards/BookCard'\n\nconst StyledWrapper = styled.div`\n  margin: 2em 0 1em;\n`\n\nconst StyledTitleGridItem = styled(GridItem)`\n  ${screenMin.m`\n    display: none;\n  `}\n`\n\nconst StyledGrid = styled(Grid)`\n  font-size: ${FONT.SIZE.S};\n\n  ${screen.l`\n    > *:nth-last-child(1) {\n      display: none;\n    }\n  `}\n`\n\ninterface Props {\n  books: BookCardType[]\n  featuredSlugs?: string[]\n  ownedSlug?: string\n}\n\nconst RelatedBooks: React.FC<Props> = ({ books, featuredSlugs, ownedSlug }) => {\n  if (!books || books.length === 0) return null\n\n  return (\n    <StyledWrapper>\n      <StyledGrid full>\n        <StyledTitleGridItem>\n          <H size=\"L\" as=\"h2\">\n            Related books\n          </H>\n        </StyledTitleGridItem>\n\n        {books.map(\n          (book: BookCardType): React.ReactNode => {\n            const featured = ownedSlug\n              ? ownedSlug === book.slug\n              : featuredSlugs && featuredSlugs.includes(book.slug)\n\n            return (\n              <GridItem key={book.id} span={1} spanFromM={3} spanFromL={2}>\n                <BookCard\n                  book={book}\n                  featured={featured}\n                  hideDetails={ownedSlug === book.slug}\n                />\n              </GridItem>\n            )\n          }\n        )}\n      </StyledGrid>\n    </StyledWrapper>\n  )\n}\n\nexport default RelatedBooks\n","import styled from 'styled-components'\nimport { COLOR, FONT } from 'styles/tokens'\nimport { trim } from 'styles/helpers'\n\nconst MarkdownWrapper = styled.div`\n  ${trim}\n\n  hr {\n    height: 0.1em;\n    background: ${COLOR.BACKGROUND_DARK};\n    border: 0;\n    margin: 1em 0;\n  }\n\n  blockquote {\n    margin-left: 0;\n    border-left: 0.2em solid ${COLOR.BACKGROUND_DARK};\n    padding-left: 1em;\n  }\n\n  h2 {\n    margin-top: 1em;\n    font-size: ${FONT.SIZE.M};\n  }\n\n  h3,\n  h4 {\n    margin-top: 1em;\n    font-size: ${FONT.SIZE.S};\n  }\n\n  img {\n    max-width: 100%;\n  }\n\n  ul {\n    list-style: disc;\n  }\n\n  ol {\n    list-style: decimal;\n  }\n\n  p,\n  ul,\n  ol {\n    margin: 0.5em 0;\n  }\n\n  ul,\n  ol {\n    padding-left: 1em;\n    ${trim}\n  }\n\n  li {\n    margin: 0.25em 0;\n  }\n\n  a {\n    text-decoration: underline;\n    text-decoration-color: var(--secondary-color);\n  }\n`\n\nexport default MarkdownWrapper\n","import { useState, useEffect } from 'react'\n\ninterface WindowSize {\n  width: number\n  height: number\n}\n\nconst useWindowSize = (): WindowSize => {\n  if (typeof window === 'undefined') {\n    return { width: null, height: null }\n  }\n\n  const getSize = (): WindowSize => ({\n    width: window.innerWidth,\n    height: window.innerHeight,\n  })\n\n  const [windowSize, setWindowSize] = useState(getSize)\n\n  useEffect(() => {\n    const handleResize = (): void => setWindowSize(getSize())\n\n    window.addEventListener('resize', handleResize)\n    return (): void => window.removeEventListener('resize', handleResize)\n  }, [])\n\n  return windowSize\n}\n\nexport default useWindowSize\n","import React from 'react'\nimport styled from 'styled-components'\n\nimport { FONT } from 'styles/tokens'\nimport { screenMax } from 'styles/responsive'\nimport Link from 'components/links/Link'\n\nconst StyledSummaryTrigger = styled.button`\n  font-size: ${FONT.SIZE.S};\n  font-weight: ${FONT.WEIGHT.BOLD};\n\n  ${screenMax.s`\n    width: 100%;\n    text-align: left;\n  `}\n`\n\nconst StyledIcon = styled.i<Pick<Props, 'open'>>`\n  display: inline-block;\n  position: relative;\n  width: 1.25em;\n  height: 1.25em;\n  vertical-align: -0.3em;\n\n  &:before,\n  &:after {\n    content: '';\n    display: block;\n    position: absolute;\n    top: 50%;\n    left: 0.35em;\n    width: 0.7em;\n    height: 0.125em;\n    background: currentColor;\n    transform-origin: 50% 50%;\n    transform: translate(-50%, -50%);\n    transition: transform 0.2s linear;\n  }\n\n  ${({ open }): string =>\n    !open &&\n    `\n    &:before {\n      transform: translate(-50%, -50%) rotate(-90deg);\n    }\n  `}\n`\n\ninterface Props {\n  children: React.ReactNode\n  open: boolean\n  ariaId?: string\n  onClick: () => void\n  className?: string\n}\n\nconst RevealTrigger: React.FC<Props> = ({\n  children,\n  open,\n  ariaId,\n  onClick,\n  className,\n}) => (\n  <Link\n    onClick={onClick}\n    aria-expanded={open}\n    aria-controls={ariaId}\n    as={StyledSummaryTrigger}\n    className={className}\n  >\n    <StyledIcon open={open} />\n    {children}\n  </Link>\n)\n\nexport default RevealTrigger\n","import qs from 'qs'\n\nconst getQueryParameters = (): { [key: string]: string | number } => {\n  if (!window.location.search) {\n    return {}\n  }\n\n  return qs.parse(window.location.search, { ignoreQueryPrefix: true })\n}\n\nexport default getQueryParameters\n","import React, { useState, useEffect } from 'react'\nimport YouTubePlayer from 'react-player/lib/players/YouTube'\n\nimport { Video } from 'types/video'\nimport { unformatTimestamp } from 'utils/formatting/time'\nimport getQueryParameters from 'utils/urls/getQueryParameters'\nimport AspectRatioWrapper from 'components/AspectRatioWrapper'\n\nconst YouTubePlayerConfig = {\n  youtube: {\n    playerVars: {\n      rel: 0,\n      controls: 1,\n    },\n  },\n}\n\ntype VideoProps = Pick<Video, 'youtubeId'>\n\ninterface Props extends VideoProps {\n  isPlaying: boolean\n  setIsPlaying: React.Dispatch<React.SetStateAction<boolean>>\n  setPlayedSeconds: React.Dispatch<React.SetStateAction<number>>\n  videoComponent: React.MutableRefObject<undefined>\n  backgroundColor: string\n}\n\nconst VideoPlayer: React.FC<Props> = ({\n  youtubeId,\n  isPlaying,\n  setIsPlaying,\n  setPlayedSeconds,\n  videoComponent,\n  backgroundColor,\n}) => {\n  const [startAtSeconds, setStartAtSeconds] = useState(0)\n\n  useEffect((): void => {\n    const params = getQueryParameters()\n    if (params.at) {\n      const startAt = unformatTimestamp(params.at as string)\n      setStartAtSeconds(startAt)\n      setPlayedSeconds(startAt)\n    }\n  }, [])\n\n  return (\n    <AspectRatioWrapper style={{ backgroundColor }}>\n      <YouTubePlayer\n        url={`https://www.youtube.com/watch?v=${youtubeId}${startAtSeconds >\n          0 && `&t=${startAtSeconds}`}`}\n        ref={videoComponent}\n        onPlay={(): void => setIsPlaying(true)}\n        onPause={(): void => setIsPlaying(false)}\n        onProgress={({ playedSeconds }): void =>\n          setPlayedSeconds(playedSeconds)\n        }\n        progressInterval={500}\n        playing={isPlaying}\n        config={YouTubePlayerConfig}\n        controls\n        width=\"100%\"\n        height=\"100%\"\n      />\n    </AspectRatioWrapper>\n  )\n}\n\nexport default VideoPlayer\n","import React from 'react'\nimport styled from 'styled-components'\n\nimport { Timestamp } from 'types/timestamp'\nimport { formatTimestamp } from 'utils/formatting/time'\nimport { COLOR, FONT } from 'styles/tokens'\nimport { trim } from 'styles/helpers'\nimport Link from 'components/links/Link'\nimport StarRating from 'components/StarRating'\nimport ArrowIcon from 'components/icons/ArrowIcon'\nimport Reveal from 'components/Reveal'\nimport BookAffiliates from 'components/BookAffiliates'\n\nconst StyledVideoTimestamp = styled.li<Pick<Props, 'active'>>`\n  padding: 0.375em 0.75em;\n  display: flex;\n  cursor: pointer;\n  font-size: ${FONT.SIZE.S};\n\n  ${({ active }): string => active && `background: ${COLOR.BACKGROUND_DARK};`}\n`\n\nconst StyledTime = styled.time`\n  min-width: 4ch;\n  margin-right: 1ch;\n  line-height: 1.25;\n`\n\nconst StyledDetails = styled.div`\n  flex: 1;\n\n  > * {\n    margin: 0;\n  }\n`\n\nconst StyledText = styled.p`\n  font-weight: ${FONT.WEIGHT.BOLD};\n  line-height: 1.25;\n`\n\nconst StyledBookLink = styled(Link)`\n  display: block;\n  width: max-content;\n  font-size: ${FONT.SIZE.S};\n`\n\nconst StyledStarRating = styled(StarRating)`\n  display: inline-block;\n  vertical-align: text-top;\n`\n\nconst StyledReveal = styled(Reveal)`\n  transition: max-height 200ms linear;\n  ${trim}\n`\n\ninterface Props extends Timestamp {\n  jumpToTimestamp: (t: number, startPlaying: boolean) => void\n  active: boolean\n}\n\nconst VideoTimestamp: React.FC<Props> = ({\n  t,\n  text,\n  link,\n  book,\n  active,\n  jumpToTimestamp,\n}) => (\n  <StyledVideoTimestamp\n    key={t}\n    onClick={(e): void => {\n      const element = e.target as HTMLElement\n      if (element.tagName !== 'a') jumpToTimestamp(t, true)\n    }}\n    active={active}\n  >\n    <StyledTime>{formatTimestamp(t)}</StyledTime>\n    <StyledDetails>\n      <StyledText>\n        {link ? (\n          <Link href={link} as=\"a\">\n            {text}\n            <ArrowIcon />\n          </Link>\n        ) : (\n          text\n        )}\n      </StyledText>\n      {book && (\n        <>\n          {book.slug && (\n            <StyledBookLink to={book.slug}>\n              <StyledStarRating of7={book.rating7} />\n              <ArrowIcon />\n            </StyledBookLink>\n          )}\n\n          <StyledReveal open={active}>\n            <BookAffiliates links={book.links} />\n          </StyledReveal>\n        </>\n      )}\n    </StyledDetails>\n  </StyledVideoTimestamp>\n)\n\nexport default VideoTimestamp\n","import React from 'react'\nimport styled from 'styled-components'\n\nimport { Timestamp } from 'types/timestamp'\nimport { COLOR, BORDER_RADIUS } from 'styles/tokens'\nimport { screen } from 'styles/responsive'\nimport { toVW, getWidthOfColumns } from 'styles/layout'\n\nimport VideoTimestamp from './VideoTimestamp'\n\nconst StyledWrapper = styled.div`\n  position: relative;\n\n  &:before,\n  &:after {\n    content: '';\n    display: block;\n    position: absolute;\n    left: -0.5em;\n    right: 0.25em;\n    height: 0.5em;\n    z-index: 1;\n    pointer-events: none;\n  }\n\n  &:before {\n    top: 0;\n    background: linear-gradient(to bottom, ${COLOR.BACKGROUND}, transparent);\n  }\n\n  &:after {\n    bottom: 0;\n    background: linear-gradient(to top, ${COLOR.BACKGROUND}, transparent);\n  }\n`\n\nconst StyledVideoTimestampList = styled.ol`\n  margin: 0 0 0 -0.5em;\n  width: calc(0.5em + 100%);\n  overflow: auto;\n  max-height: 300px;\n  padding: 0.5em 0;\n\n  ${screen.l`\n    max-height: calc(1em + ${toVW((getWidthOfColumns.l(7) * 9) / 16)});\n  `}\n\n  ${screen.xl`\n    max-height: calc(1em + ${toVW((getWidthOfColumns.xl(8) * 9) / 16)});\n  `}\n\n  ::-webkit-scrollbar {\n    width: 0.25em;\n    border-left: 2px solid ${COLOR.BACKGROUND_DARK};\n    border-radius: 0 ${BORDER_RADIUS.S} ${BORDER_RADIUS.S} 0;\n  }\n\n  ::-webkit-scrollbar-thumb {\n    background: rgba(0, 0, 0, 0.2);\n    border-width: 0.5em 0;\n    border-style: solid;\n    border-color: ${COLOR.BACKGROUND};\n  }\n`\n\ninterface Props {\n  timestamps: Timestamp[]\n  playedSeconds: number\n  setPlayedSeconds: React.Dispatch<React.SetStateAction<number>>\n  setIsPlaying: React.Dispatch<React.SetStateAction<boolean>>\n  videoComponent: React.MutableRefObject<undefined>\n}\n\nconst VideoTimestampList: React.FC<Props> = ({\n  timestamps,\n  playedSeconds,\n  setPlayedSeconds,\n  setIsPlaying,\n  videoComponent,\n}) => {\n  const jumpToTimestamp = (t: number, startPlaying: boolean): void => {\n    if (!videoComponent.current) return\n    const target = videoComponent.current as { seekTo: (t: number) => {} }\n\n    target.seekTo(t)\n    setPlayedSeconds(t)\n    if (startPlaying) setIsPlaying(true)\n  }\n\n  let segment: number\n  timestamps.forEach(({ t }, i) => {\n    if (playedSeconds >= t) segment = i\n  })\n\n  return (\n    <StyledWrapper>\n      <StyledVideoTimestampList>\n        {timestamps.map(({ t, text, link, book }, i) => (\n          <VideoTimestamp\n            key={t}\n            t={t}\n            text={text}\n            link={link}\n            book={book}\n            jumpToTimestamp={jumpToTimestamp}\n            active={segment === i}\n          />\n        ))}\n      </StyledVideoTimestampList>\n    </StyledWrapper>\n  )\n}\n\nexport default VideoTimestampList\n","import React, { useState } from 'react'\nimport styled from 'styled-components'\n\nimport { Video } from 'types/video'\nimport { formatDate } from 'utils/formatting/time'\nimport { formatNumberInThousands } from 'utils/formatting/numbers'\nimport useWindowSize from 'utils/hooks/useWindowSize'\nimport { FONT, BREAKPOINT } from 'styles/tokens'\nimport { trim } from 'styles/helpers'\nimport { screen, screenMin } from 'styles/responsive'\nimport Reveal from 'components/Reveal'\nimport RevealTrigger from 'components/Reveal/RevealTrigger'\nimport Link from 'components/links/Link'\n\nconst META_ARIA_ID = 'book-meta'\n\nconst StyledAside = styled.aside`\n  margin-bottom: 1em;\n`\n\nconst StyledRevealTrigger = styled(RevealTrigger)`\n  ${screenMin.m`\n    display: none;\n  `}\n`\n\nconst StyledReveal = styled.dl`\n  ${trim}\n\n  ${screen.s`\n    padding: 0.5em 0 0 1em;\n  `}\n`\n\nconst StyledDt = styled.dt`\n  font-size: ${FONT.SIZE.S};\n  font-weight: ${FONT.WEIGHT.BOLD};\n  margin: 0.5em 0 0;\n\n  ${screenMin.m`\n    margin: 1em 0 0;\n  `}\n`\n\nconst StyledDd = styled.dd`\n  font-size: ${FONT.SIZE.S};\n  margin: 0;\n`\n\ntype Props = Pick<\n  Video,\n  'datePublished' | 'viewCount' | 'commentCount' | 'youtubeId'\n>\n\nconst VideoMeta: React.FC<Props> = ({\n  datePublished,\n  viewCount,\n  commentCount,\n  youtubeId,\n}) => {\n  const { width: windowWidth } = useWindowSize()\n  const [isOpen, setIsOpen] = useState(false)\n\n  return (\n    <StyledAside>\n      <StyledRevealTrigger\n        onClick={(): void => setIsOpen(!isOpen)}\n        open={isOpen}\n        ariaId={META_ARIA_ID}\n      >\n        Video information\n      </StyledRevealTrigger>\n\n      <Reveal\n        as={StyledReveal}\n        open={(windowWidth && windowWidth > BREAKPOINT.S) || isOpen}\n        ariaId={META_ARIA_ID}\n      >\n        <StyledDt>Date posted</StyledDt>\n        <StyledDd>\n          <time>{formatDate(datePublished)}</time>\n        </StyledDd>\n\n        {viewCount >\n          parseInt(process.env.GATSBY_YOUTUBE_VIEWS_MINIMUM_VISIBLE) && (\n          <>\n            <StyledDt>Statistics</StyledDt>\n            <StyledDd>{formatNumberInThousands(viewCount)} views</StyledDd>\n            <StyledDd>\n              <Link as=\"a\" href={`https://youtu.be/${youtubeId}`}>\n                {formatNumberInThousands(commentCount)} comments\n              </Link>\n            </StyledDd>\n          </>\n        )}\n      </Reveal>\n    </StyledAside>\n  )\n}\n\nexport default VideoMeta\n","import React from 'react'\nimport styled from 'styled-components'\n\nimport { Book } from 'types/book'\nimport { FONT } from 'styles/tokens'\nimport { trim } from 'styles/helpers'\nimport Link from 'components/links/Link'\nimport StarRating from 'components/StarRating'\nimport ArrowIcon from 'components/icons/ArrowIcon'\nimport BookAffiliates from 'components/BookAffiliates'\n\nconst StyledAside = styled.aside`\n  ${trim}\n`\n\nconst StyledLink = styled(Link)`\n  font-size: ${FONT.SIZE.S};\n  font-weight: ${FONT.WEIGHT.BOLD};\n`\n\nconst StyledStarRating = styled(StarRating)`\n  font-size: ${FONT.SIZE.S};\n`\n\ntype Props = Pick<Book, 'rating7' | 'slug' | 'links'>\n\nconst VideoOwnedBook: React.FC<Props> = ({ rating7, slug, links }) => (\n  <StyledAside>\n    <StyledStarRating of7={rating7} />\n    <StyledLink to={slug}>\n      Book page\n      <ArrowIcon />\n    </StyledLink>\n\n    <BookAffiliates links={links} />\n  </StyledAside>\n)\n\nexport default VideoOwnedBook\n","import React, { useRef, useState } from 'react'\nimport { graphql } from 'gatsby'\nimport styled from 'styled-components'\n\nimport { PageProps } from 'types/page'\nimport PATHS from 'routes/paths'\nimport Layout from 'Layout'\nimport { Video } from 'types/video'\nimport { BookCardType } from 'types/book'\nimport { BookSnapshot } from 'types/book'\nimport { stripHtml } from 'utils/formatting/text'\nimport H from 'components/H'\nimport Grid from 'components/Grid'\nimport GridItem from 'components/Grid/GridItem'\nimport RelatedBooks from 'components/RelatedBooks'\nimport MarkdownWrapper from 'components/MarkdownWrapper'\nimport { screen, screenMin, screenMax } from 'styles/responsive'\nimport { FONT } from 'styles/tokens'\nimport { GAP, toVW } from 'styles/layout'\n\nimport VideoPlayer from './VideoPlayer'\nimport VideoTimestampList from './VideoTimestampList'\nimport VideoMeta from './VideoMeta'\nimport VideoOwnedBook from './VideoOwnedBook'\n\n// import YouTubeDescription from 'components/YouTubeDescription'\n\nconst StyledTimestampGridItem = styled(GridItem)`\n  margin-top: 0.5em;\n\n  ${screenMin.l`\n    margin-bottom: -0.5em;\n  `}\n`\n\nconst StyledMeta = styled.aside`\n  ${screenMin.m`\n    margin-top: 1em;\n  `}\n\n  ${screenMin.l`\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    grid-gap: ${toVW(GAP.L)};\n  `}\n\n  ${screen.xl`\n    grid-gap: ${toVW(GAP.XL)};\n  `}\n`\n\nconst StyledTitleWrapper = styled.div`\n  ${screenMin.l`\n    align-self: end;\n  `}\n`\n\nconst StyledTitle = styled(H)`\n  margin: 0.5em 0 -0.2em;\n`\n\nconst StyledBlockquote = styled.blockquote`\n  position: relative;\n  margin: 1.5em 0 1.5em 1.5em;\n\n  ${screenMax.m`\n    display: none;\n  `}\n\n  &:before {\n    content: 'â€œ';\n    position: absolute;\n    left: -0.5em;\n    top: 0.25em;\n    line-height: 0;\n    font-size: 4em;\n    font-family: ${FONT.FAMILY.DECORATIVE};\n  }\n`\n\ninterface Props extends PageProps {\n  data: {\n    video: Video\n  }\n}\n\nconst VideoPage: React.FC<Props> = ({ data: { video }, location }) => {\n  const [isPlaying, setIsPlaying] = useState(false)\n  const [playedSeconds, setPlayedSeconds] = useState(0)\n  const videoComponent = useRef()\n\n  const ownedBook = video.ownedBy as BookSnapshot\n  const relatedBooks = video.relatedBooks as BookCardType[]\n\n  const featuredRelatedBookSlugs = (video.timestamps || [])\n    .filter((b) => b.book)\n    .map((b) => b.book.slug)\n\n  const flipLayout = ownedBook || !video.timestamps\n\n  return (\n    <Layout\n      location={location}\n      navTitle=\"Back to all videos\"\n      navTitleLink={PATHS.VIDEOS}\n      title={video.title}\n      description={stripHtml(video.html)}\n      shareImage={video.image.childImageSharp.share.src}\n    >\n      {/* <YouTubeDescription video={video} /> */}\n\n      <Grid full>\n        <GridItem columnsFromL=\"1/8\" columnsFromXL=\"1/9\">\n          <VideoPlayer\n            videoComponent={videoComponent}\n            youtubeId={video.youtubeId}\n            isPlaying={isPlaying}\n            setIsPlaying={setIsPlaying}\n            setPlayedSeconds={setPlayedSeconds}\n            backgroundColor={video.image.colors.muted}\n          />\n        </GridItem>\n\n        <GridItem\n          as={StyledTitleWrapper}\n          columnsFromM=\"5 / 13\"\n          columnsFromL=\"8 / 14\"\n          columnsFromXL=\"9 / 15\"\n          rows={flipLayout ? '2/3' : '3/4'}\n          rowsFromL={flipLayout ? '1/2' : '2/3'}\n        >\n          {video.quote && <StyledBlockquote>{video.quote}</StyledBlockquote>}\n          <StyledTitle as=\"h1\" size=\"L\">\n            {video.title}\n          </StyledTitle>\n        </GridItem>\n\n        {video.html && (\n          <GridItem\n            columnsFromM=\"5 / 13\"\n            columnsFromL=\"8/14\"\n            columnsFromXL=\"9/15\"\n          >\n            <MarkdownWrapper dangerouslySetInnerHTML={{ __html: video.html }} />\n          </GridItem>\n        )}\n\n        <GridItem\n          as={StyledMeta}\n          spanRows={3}\n          spanRowsFromL={video.html && video.timestamps ? 2 : 1}\n          spanFromM={4}\n          columnsFromL=\"2/8\"\n          columnsFromXL=\"3/9\"\n        >\n          <VideoMeta\n            datePublished={video.datePublished}\n            viewCount={video.viewCount}\n            commentCount={video.commentCount}\n            youtubeId={video.youtubeId}\n          />\n\n          {ownedBook && (\n            <VideoOwnedBook\n              rating7={ownedBook.rating7}\n              slug={ownedBook.slug}\n              links={ownedBook.links}\n            />\n          )}\n        </GridItem>\n\n        {video.timestamps && (\n          <GridItem\n            as={StyledTimestampGridItem}\n            columnsFromM=\"5 / 13\"\n            columnsFromL=\"8/15\"\n            columnsFromXL=\"9/17\"\n            rows={flipLayout ? '3/4' : '2/3'}\n            rowsFromL={flipLayout ? '2/3' : '1/2'}\n            style={{\n              marginTop: flipLayout ? '-0.25em' : '-0.75em',\n              marginBottom: '-0.5em',\n              alignSelf: flipLayout ? 'start' : 'end',\n            }}\n          >\n            <VideoTimestampList\n              timestamps={video.timestamps}\n              playedSeconds={playedSeconds}\n              setPlayedSeconds={setPlayedSeconds}\n              setIsPlaying={setIsPlaying}\n              videoComponent={videoComponent}\n            />\n          </GridItem>\n        )}\n      </Grid>\n\n      <RelatedBooks\n        books={relatedBooks}\n        featuredSlugs={featuredRelatedBookSlugs}\n        ownedSlug={ownedBook && ownedBook.slug}\n      />\n    </Layout>\n  )\n}\n\nexport const query = graphql`\n  query VideoPage($id: String!) {\n    video: video(id: { eq: $id }) {\n      ...VideoFields\n    }\n  }\n`\n\nexport default VideoPage\n","import { makeIsbn10 } from 'utils/formatting/isbn'\n\nexport const AFFILIATES = {\n  GOODREADS: 'gr',\n  AMAZON: 'amzn',\n  BOOK_DEPOSITORY: 'bd',\n}\n\nexport const getLink = (isbn: string, affiliateAbbr: string): string => {\n  if (affiliateAbbr === AFFILIATES.GOODREADS)\n    return `https://www.goodreads.com/search?query=${isbn}`\n\n  if (affiliateAbbr === AFFILIATES.AMAZON)\n    return `https://amazon.com/dp/${makeIsbn10(String(isbn))}?tag=chareads-20`\n\n  if (affiliateAbbr === AFFILIATES.BOOK_DEPOSITORY)\n    return `https://bookdepository.com/search?searchTerm=${isbn}&a_id=char`\n}\n\nexport const getShortLink = (isbn: string, affiliateAbbr: string): string =>\n  `https://cha.rs/${parseInt(isbn)\n    .toString(36)\n    .toUpperCase()}/${affiliateAbbr}`\n\nexport const getAffiliateLinks = (isbn: string): object => {\n  const long = {}\n  const short = {}\n\n  Object.values(AFFILIATES).forEach((affiliate: string) => {\n    long[affiliate] = getLink(isbn, affiliate)\n    short[affiliate] = getShortLink(isbn, affiliate)\n  })\n\n  return {\n    long,\n    short,\n  }\n}\n","import React from 'react'\nimport styled from 'styled-components'\n\nimport { Book } from 'types/book'\nimport { AFFILIATES } from 'utils/urls/affiliates'\nimport { FONT } from 'styles/tokens'\nimport { screenMin } from 'styles/responsive'\nimport ArrowIcon from 'components/icons/ArrowIcon'\n\nconst AFFILIATE_ACTIONS = {\n  [AFFILIATES.GOODREADS]: 'See on Goodreads',\n  [AFFILIATES.AMAZON]: 'Buy on Amazon',\n  [AFFILIATES.BOOK_DEPOSITORY]: 'Buy on Book Depository',\n}\n\nconst StyledLi = styled.li`\n  font-size: ${FONT.SIZE.S};\n\n  ${screenMin.l`\n    margin-left: -1.5em;\n  `}\n`\n\nconst StyledArrowIcon = styled(ArrowIcon)`\n  margin: 0 0.75em 0 0;\n`\n\ntype Props = Pick<Book, 'links'>\n\nconst BookAffiliates: React.FC<Props> = ({ links }) => (\n  <ol>\n    {Object.entries(AFFILIATE_ACTIONS).map(([affiliateAbbr, label]) => (\n      <StyledLi key={affiliateAbbr}>\n        <a href={links.long[affiliateAbbr]}>\n          <StyledArrowIcon />\n          {label}\n        </a>\n      </StyledLi>\n    ))}\n  </ol>\n)\n\nexport default BookAffiliates\n"],"sourceRoot":""}